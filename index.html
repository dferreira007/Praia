<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Contagem regressiva - F√©rias da Galera!</title>
<style>
  :root {
    --bg-sky: #87CEEB;
    --sand: #FFD700;
    --card: #ffffffcc;
    --sea: #4a90e2;
    --sun: #FFD700;
    --palm-green: #388e3c;
    --palm-trunk: #795548;
    --cloud: #f5f5f5;
    --skin-light: #fce4d6;
    --skin-dark: #603813;
  }

  * { box-sizing: border-box; font-family: 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; }

  body {
    margin: 0;
    min-height: 100vh;
    background: linear-gradient(180deg, var(--bg-sky) 0%, #a0e3f7 40%, #f5f7ff 60%);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 24px;
    color: #0b2545;
  }

  .stage {
    width: 100%;
    max-width: 1100px;
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.35), rgba(255, 255, 255, 0.05));
    border-radius: 20px;
    padding: 28px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.12);
    position: relative;
    overflow: hidden;
  }

  header { display: flex; align-items: center; justify-content: space-between; gap: 20px; position: relative; z-index: 5; }
  h1 { font-size: 1.8rem; margin: 0 0 6px 0; letter-spacing: 0.2px; }
  p.lead { margin: 0; color: #083252a8; font-size: 0.95rem; }

  .countdown { display: flex; gap: 12px; margin: 18px 0 20px; position: relative; z-index: 5; flex-wrap: wrap; }
  .time-card { background: var(--card); padding: 14px 18px; border-radius: 12px; min-width: 96px; text-align: center; box-shadow: 0 6px 18px rgba(8, 37, 82, 0.06); animation: popIn .8s both; }
  @keyframes popIn { from { opacity: 0; transform: translateY(14px) scale(.98); } to { opacity: 1; transform: translateY(0) scale(1); } }
  .time-card .num { font-size: 1.6rem; font-weight: 700; }
  .time-card .lbl { font-size: 0.85rem; color: #123c57a6; margin-top: 6px; }
  
  /* --- CENA PRINCIPAL --- */
  .animation-scene {
    width: 100%;
    height: 380px;
    margin-top: 20px;
    position: relative;
    overflow: hidden;
    border-radius: 15px;
    background: linear-gradient(180deg, var(--bg-sky) 0%, #a0e3f7 100%);
    box-shadow: inset 0 -10px 20px rgba(0,0,0,0.1);
    cursor: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='40' height='48' viewport='0 0 100 100' style='font-size:24px;'><text y='50%'>üéØ</text></svg>") 16 16, auto;
  }

  .sky { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
  .sun-beach { position: absolute; top: 30px; right: 50px; width: 70px; height: 70px; background: var(--sun); border-radius: 50%; box-shadow: 0 0 30px var(--sun); z-index: 1; animation: pulse-sun 3s ease-in-out infinite alternate; }
  @keyframes pulse-sun { from { transform: scale(1); } to { transform: scale(1.05); } }

  .cloud { position: absolute; background: var(--cloud); border-radius: 50%; opacity: 0.7; animation: move-cloud var(--duration) linear infinite; z-index: 0; }
  .cloud:nth-child(1) { width: 80px; height: 30px; top: 30px; left: -10%; --duration:25s; }
  .cloud:nth-child(2) { width: 120px; height: 40px; top: 60px; left: -20%; --duration:30s; animation-delay: 5s;}
  @keyframes move-cloud { from { transform: translateX(-150px); } to { transform: translateX(1200px); } }

  .beach-scene { position: absolute; bottom: 0; left: 0; width: 100%; height: 70%; background: var(--sand); z-index: 1; }
  .sea-scene { position: absolute; top: 0; left: 0; width: 100%; height: 60%; background: linear-gradient(to top, var(--sea) 0%, #4682B4 100%); }

  .waves-animated { position: absolute; width: 100%; height: 20px; background: rgba(255,255,255,0.8); border-radius: 50%; bottom: 55%; left: 0; z-index: 2; animation: waves-motion 4s ease-in-out infinite alternate; }
  .waves-animated::before, .waves-animated::after { content: ''; position: absolute; width: 80%; height: 100%; background: rgba(255,255,255,0.6); border-radius: 50%; opacity: 0.8; }
  .waves-animated::before { left: -10%; top: 5px; animation: waves-motion-alt 3s ease-in-out infinite alternate; }
  .waves-animated::after { right: -10%; top: -5px; animation: waves-motion 3.5s ease-in-out infinite alternate reverse; }
  @keyframes waves-motion { from { transform: translateX(0) scaleX(1); } to { transform: translateX(20px) scaleX(1.05); } }
  @keyframes waves-motion-alt { from { transform: translateX(0) scaleX(1.05); } to { transform: translateX(-20px) scaleX(1); } }

  .palm-tree-beach { position: absolute; bottom: 70px; width: 60px; height: 160px; z-index: 3; animation: palm-sway 5s ease-in-out infinite alternate; }
  .palm-tree-beach.left { left: 8%; transform-origin: bottom center; }
  .palm-tree-beach.right { right: 8%; transform-origin: bottom center; animation-delay: 2s; }
  @keyframes palm-sway { from { transform: rotate(0deg); } to { transform: rotate(5deg); } }
  .palm-trunk { width: 12px; height: 100%; background: var(--palm-trunk); border-radius: 6px; position: absolute; left: 50%; transform: translateX(-50%); }
  .palm-leaves { position: absolute; top: -40px; left: -30px; width: 60px; height: 60px; background: var(--palm-green); border-radius: 50%; box-shadow: -20px -10px 0 var(--palm-green), 20px -10px 0 var(--palm-green), 0px -35px 0 var(--palm-green); }

  .guarda-sol { position: absolute; bottom: 80px; left: 25%; width: 10px; height: 120px; z-index: 4; animation: sway 4s ease-in-out infinite alternate; }
  .guarda-sol::before { content:''; position: absolute; bottom: 0; width: 100%; height: 100%; background: #fff; border-radius: 5px; }
  .guarda-sol::after { content:''; position: absolute; top: 0; left: 50%; transform: translateX(-50%); width: 120px; height: 80px; background: repeating-linear-gradient(45deg, #ff6b6b, #ff6b6b 20px, #ffd166 20px, #ffd166 40px); border-radius: 50% 50% 0 0; }
  @keyframes sway { from { transform: rotate(-2deg); } to { transform: rotate(2deg); } }
  
  .caranguejo { position: absolute; bottom: 20px; left: -50px; width: 40px; height: 30px; background: var(--crab-red); border-radius: 50% 50% 0 0; z-index: 12; animation: walk-crab 15s linear infinite; }
  .caranguejo::before, .caranguejo::after { content:''; position: absolute; top: 5px; width: 15px; height: 15px; background: var(--crab-red); border: 2px solid #a41623; border-radius: 50%; }
  .caranguejo::before { left: -10px; transform: rotate(-30deg); }
  .caranguejo::after { right: -10px; transform: rotate(30deg); }
  @keyframes walk-crab { 0% { transform: translateX(0); } 48% { transform: translateX(calc(1100px - 50px)) translateY(0); } 50% { transform: translateX(calc(1100px - 50px)) translateY(5px) rotateY(180deg); } 98% { transform: translateX(0) translateY(0) rotateY(180deg); } 100% { transform: translateX(0) translateY(5px) rotateY(0deg); } }

  .bulldog { position: absolute; bottom: 30px; left: 50%; width: 50px; height: 40px; background: var(--dog-brown); border-radius: 10px; z-index: 11; animation: play-dog 5s ease-in-out infinite; }
  .bulldog::before { content:''; position: absolute; top: -15px; left: 5px; width: 40px; height: 25px; background: var(--dog-brown); border-radius: 8px; } /* Cabe√ßa */
  .bulldog::after { content:''; position: absolute; top: -25px; left: 0px; width: 15px; height: 20px; background: var(--dog-brown); border-radius: 8px 8px 0 0; box-shadow: 25px 0 0 var(--dog-brown); } /* Orelhas */
  @keyframes play-dog { 0%, 100% { transform: translateX(0) rotate(0); } 25% { transform: translateX(-150px) rotate(-10deg); } 50% { transform: translateX(0) rotate(0) scaleY(0.8); } 75% { transform: translateX(150px) rotate(10deg); } }

  /* --- PERSONAGENS ESTILO DESENHO ANIMADO --- */
  .person-group-beach { position: absolute; bottom: 5px; width: 100%; display: flex; justify-content: center; gap: 30px; z-index: 10; }
  .person-char { width: 60px; height: 90px; position: relative; cursor: pointer; transition: transform 0.1s ease-out; }
  .person-char.hit { animation: shake 0.4s ease-in-out; }
  @keyframes shake { 0%, 100% { transform: translateY(0) translateX(0); } 20% { transform: translateY(0) translateX(-5px) rotate(-3deg); } 40% { transform: translateY(0) translateX(5px) rotate(3deg); } 60% { transform: translateY(0) translateX(-3px) rotate(-2deg); } 80% { transform: translateY(0) translateX(3px) rotate(2deg); } }
  .person-char .head { width: 40px; height: 40px; border-radius: 50%; position: absolute; left: 50%; top: -20px; transform: translateX(-50%); animation: blink 4s infinite step-end; }
  @keyframes blink { 21%, 41%, 61%, 81% { transform: translateX(-50%) scaleY(0.1); } 0%, 20%, 22%, 40%, 42%, 60%, 62%, 80%, 82%, 100% { transform: translateX(-50%) scaleY(1); } }
  .speech-bubble { 
    position: absolute; top: -50px; left: 50%; transform: translateX(-50%); 
    background: #ffffff; border: 1px solid #ccc; border-radius: 10px; 
    padding: 5px 10px; font-size: 0.8em; white-space: nowrap; 
    opacity: 0; animation: bubble-talk 3s ease-in-out infinite; 
    pointer-events: none; z-index: 100;
  }
  @keyframes bubble-talk { 0%, 10%, 90%, 100% { opacity: 0; transform: translateX(-50%) translateY(5px); } 30%, 70% { opacity: 1; transform: translateX(-50%) translateY(0px); } }

  .p-jackson .char-body { width: 50px; height: 60px; background: #4a4a4a; border-radius: 10px; bottom: 0; left: 5px; }
  .p-jackson .head { background: var(--skin-dark); box-shadow: inset -6px -3px 0 0px #eee, inset 6px -3px 0 0px #eee; }
  .p-jackson::before { content: 'üëî'; font-size: 20px; position: absolute; top: 20px; left: 15px; z-index: 1; }
  
  .p-nathalia .char-body { width: 45px; height: 55px; background: #f8f9fa; border-radius: 8px; bottom: 0; left: 8px; }
  .p-nathalia .head { background: var(--skin-light); border-top: 6px solid black; border-radius: 50% 50% 0 0; }
  .p-nathalia::before { content: '‚öïÔ∏è'; font-size: 20px; position: absolute; top: 20px; left: 15px; color: red; }
  
  .p-diego .char-body { width: 50px; height: 58px; background: #007bff; border-radius: 10px; bottom: 0; left: 5px; }
  .p-diego .head { background: var(--skin-light); }
  .p-diego .head::before { content: ''; position: absolute; top: 6px; left: 3px; width: 14px; height: 6px; border: 2px solid #333; border-radius: 3px; box-shadow: 10px 0 0 #333; }
  .p-diego .head::after { content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 70%; background: var(--hair-red); border-radius: 0 0 10px 10px; }
  .p-diego::before { content: 'üéß'; font-size: 12px; position: absolute; top: -2px; left: -8px; transform: rotate(-10deg); }

  .p-flavia .char-body { width: 48px; height: 56px; background: #e83e8c; border-radius: 8px; bottom: 0; left: 6px; }
  .p-flavia .head { background: var(--skin-light); border: 3px solid #8b4513; border-radius: 50%; }
  .p-flavia::before { content: '$'; font-size: 20px; font-weight: bold; color: #28a745; position: absolute; top: 20px; left: 18px; }
  
  .p-otavio .char-body { width: 52px; height: 60px; background: #28a745; border-radius: 10px; bottom: 0; left: 4px; }
  .p-otavio .head { background: var(--skin-light); border: 3px dotted #a0522d; border-radius: 50%; }
  .p-otavio::before { content: ''; position: absolute; top: -18px; left: 50%; transform: translateX(-50%); width: 30px; height: 12px; background: #ffc107; border-radius: 7px 7px 0 0; border-bottom: 3px solid #e0a800; z-index: 1; }
  
  .p-fernanda .char-body { width: 47px; height: 57px; background: #fd7e14; border-radius: 8px; bottom: 0; left: 7px; }
  .p-fernanda .head { background: var(--skin-light); border-top: 5px solid #f0e68c; border-radius: 50% 50% 0 0; }
  .p-fernanda::before { content: 'üëì'; font-size: 20px; position: absolute; top: -20px; left: 15px; z-index: 2; }
  .p-fernanda::after { content: '‚úÖ'; font-size: 18px; position: absolute; top: 20px; left: 18px; }

  /* Novo estilo para o placar de boladas */
  .boladas-placar {
    display: none;
    flex-direction: column;
    align-items: center;
    gap: 15px;
    margin-top: 15px;
  }
  .placar-item {
    text-align: center;
    font-size: 0.9em;
    font-weight: bold;
    color: #0b2545;
    background: #fff;
    padding: 8px 15px;
    border-radius: 8px;
  }

  /* Estilos para a tela final de resultado */
  #winnerScreen {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(5px);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      z-index: 20;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.5s ease-in-out;
  }
  #winnerScreen.active {
      opacity: 1;
      visibility: visible;
  }
  #winnerScreen h2 {
      font-size: 2.5rem;
      margin-bottom: 10px;
      color: #d90429;
  }
  #winnerScreen p {
      font-size: 1.2rem;
      color: #0b2545;
  }

  /* Estilos para a sele√ß√£o de personagem */
  #player-select-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(5px);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      z-index: 25;
  }
  #player-select-container h3 {
      margin-bottom: 20px;
      color: #0b2545;
  }
  #player-select-container .char-selection {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
  }
  #player-select-container .char-card {
      padding: 15px;
      border-radius: 12px;
      background: var(--card);
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      cursor: pointer;
      transition: transform 0.2s;
  }
  #player-select-container .char-card:hover {
      transform: scale(1.05);
  }

  #beachBall {
    position: absolute;
    bottom: 50px;
    left: 50%;
    width: 30px;
    height: 30px;
    background: linear-gradient(45deg, #ff6b6b 0%, #ff6b6b 25%, #ffd166 25%, #ffd166 50%, #4a90e2 50%, #4a90e2 75%, #ffffff 75%, #ffffff 100%);
    border-radius: 50%;
    transform: translate(-50%, -50%);
    transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    z-index: 15;
    will-change: transform;
    box-shadow: 0 0 10px rgba(0,0,0,0.2);
  }
  
  #beachBall.thrown {
    animation: throw-ball 0.5s ease-out;
    transform: translate(var(--target-x), var(--target-y));
  }
  
  @keyframes throw-ball {
    from { transform: translate(-50%, -50%) scale(1); }
    to { transform: translate(var(--target-x), var(--target-y)) scale(1.1); }
  }
</style>
</head>
<body>
  <div class="stage">
    <header>
      <h1>√öltima contagem antes das F√©rias!</h1>
      <p class="lead">Faltam... <strong>14 de novembro de 2025</strong> para a gl√≥ria!</p>
    </header>

    <div class="countdown" id="countdown">
      <div class="time-card"><div class="num" id="days">0</div><div class="lbl">Dias</div></div>
      <div class="time-card"><div class="num" id="hours">0</div><div class="lbl">Horas</div></div>
      <div class="time-card"><div class="num" id="minutes">0</div><div class="lbl">Minutos</div></div>
      <div class="time-card"><div class="num" id="seconds">0</div><div class="lbl">Segundos</div></div>
    </div>
    
    <div class="boladas-placar" id="boladasPlacar">
      <h5>Boladas de F√©rias:</h5>
    </div>

    <section class="animation-scene" id="animationScene">
      <div id="winnerScreen">
          <h2 id="winnerTitle"></h2>
          <p id="winnerMessage"></p>
      </div>

      <div class="sky">
        <div class="sun-beach"></div>
        <div class="cloud"></div><div class="cloud"></div><div class="cloud"></div>
      </div>
      
      <div class="beach-scene">
        <div class="sea-scene"></div>
        <div class="waves-animated"></div>
      </div>
      
      <div class="palm-tree-beach left">
        <div class="palm-trunk"></div>
        <div class="palm-leaves"></div>
      </div>
      <div class="palm-tree-beach right">
        <div class="palm-trunk"></div>
        <div class="palm-leaves"></div>
      </div>
      
      <div class="guarda-sol"></div>
      <div class="caranguejo"></div>
      <div class="bulldog"></div>

      <div class="person-group-beach">
        <div class="person-char p-jackson" data-personagem="Jackson">
          <div class="char-body"></div>
          <div class="head"></div>
          <div class="speech-bubble">Jackson</div>
        </div>
        <div class="person-char p-nathalia" data-personagem="Nathalia">
          <div class="char-body"></div>
          <div class="head"></div>
          <div class="speech-bubble">Nathalia</div>
        </div>
        <div class="person-char p-diego" data-personagem="Diego">
          <div class="char-body"></div>
          <div class="head"></div>
          <div class="speech-bubble">Diego</div>
        </div>
        <div class="person-char p-flavia" data-personagem="Flavia">
          <div class="char-body"></div>
          <div class="head"></div>
          <div class="speech-bubble">Flavia</div>
        </div>
        <div class="person-char p-otavio" data-personagem="Otavio">
          <div class="char-body"></div>
          <div class="head"></div>
          <div class="speech-bubble">Otavio</div>
        </div>
        <div class="person-char p-fernanda" data-personagem="Fernanda">
          <div class="char-body"></div>
          <div class="head"></div>
          <div class="speech-bubble">Fernanda</div>
        </div>
      </div>
      
      <div class="beach-ball" id="beachBall"></div>
    </section>

    <div class="instructions">
      <h3>Arremesse a bola da loucura!</h3>
      <ul>
        <li><strong>Acerte o Alvo:</strong> Clique em qualquer lugar na cena para arremessar a bola de praia. Acerte um amigo e aumente a contagem de boladas dele!</li>
        <li><strong>Placar da Galera:</strong> Veja quem est√° "levando mais boladas" em tempo real.</li>
        <li><strong>Mural de Recados:</strong> Deixe uma mensagem an√¥nima para a galera pirar!</li>
      </ul>
    </div>
    
    <div id="player-select-container">
        <h3>Escolha seu personagem para come√ßar a jogar:</h3>
        <div class="char-selection" id="charSelection">
            <div class="char-card p-jackson">Jackson</div>
            <div class="char-card p-nathalia">Nathalia</div>
            <div class="char-card p-diego">Diego</div>
            <div class="char-card p-flavia">Flavia</div>
            <div class="char-card p-otavio">Otavio</div>
            <div class="char-card p-fernanda">Fernanda</div>
        </div>
    </div>
  </div>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore-compat.js"></script>
<script>
    const firebaseConfig = {
      apiKey: "AIzaSyB2p4GqwLNlAJFBEjllAZsdDWcUTuDqVZk",
      authDomain: "praia-d2e6b.firebaseapp.com",
      projectId: "praia-d2e6b",
      storageBucket: "praia-d2e6b.appspot.com",
      messagingSenderId: "814972166582",
      appId: "1:814972166582:web:7ad70337cffb18d3336117"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
</script>


<script>
  const targetDate = new Date('2025-11-14T00:00:00');
  const characters = document.querySelectorAll('.person-char');
  const scene = document.getElementById('animationScene');
  const boladasPlacar = document.getElementById('boladasPlacar');
  const winnerScreen = document.getElementById('winnerScreen');
  const playerSelectContainer = document.getElementById('player-select-container');
  let selectedPlayer = null;

  let hitsData = {};

  const charactersList = ['Jackson', 'Nathalia', 'Diego', 'Flavia', 'Otavio', 'Fernanda'];

  function pad(n){return String(n).padStart(2,'0');}

  function displayWinner() {
    let winner = null;
    let mostHits = 0;
    let target = null;

    for (const hitter in hitsData) {
      for (const t in hitsData[hitter]) {
        if (hitsData[hitter][t] > mostHits) {
          mostHits = hitsData[hitter][t];
          winner = hitter;
          target = t;
        }
      }
    }

    const winnerTitle = document.getElementById('winnerTitle');
    const winnerMessage = document.getElementById('winnerMessage');

    if (winner && mostHits > 0) {
      winnerTitle.textContent = "TEMOS UM CAMPE√ÉO DAS BOLADAS!";
      winnerMessage.textContent = `${winner} deu ${mostHits} boladas em ${target}!`;
    } else {
      winnerTitle.textContent = "Ningu√©m se deu mal!";
      winnerMessage.textContent = "A contagem zerou sem boladas. Que f√©rias entediantes...";
    }
    
    winnerScreen.classList.add('active');
  }

  function updateCountdown() {
    const now = new Date();
    const diff = targetDate - now;
    if (diff <= 0) {
      document.querySelectorAll('.num').forEach(el => el.textContent = "00");
      document.querySelector('h1').textContent = "Bora pra praiaaa!";
      document.querySelector('p.lead').textContent = "As f√©rias chegaram! üéâ";
      clearInterval(countdownInterval);
      displayWinner();
      return;
    }
    const sec = Math.floor(diff / 1000);
    const d = Math.floor(sec / 86400);
    const h = Math.floor((sec % 86400) / 3600);
    const m = Math.floor((sec % 3600) / 60);
    const s = sec % 60;
    document.getElementById('days').textContent = pad(d);
    document.getElementById('hours').textContent = pad(h);
    document.getElementById('minutes').textContent = pad(m);
    document.getElementById('seconds').textContent = pad(s);
  }
  const countdownInterval = setInterval(updateCountdown, 1000);
  updateCountdown();

  function updatePlacar() {
    boladasPlacar.innerHTML = '<h5>Boladas de F√©rias:</h5>';
    let allHits = {};
    for (const hitter in hitsData) {
        for (const target in hitsData[hitter]) {
            allHits[target] = (allHits[target] || 0) + hitsData[hitter][target];
        }
    }
    const sortedTargets = Object.entries(allHits).sort((a, b) => b[1] - a[1]);
    sortedTargets.forEach(([target, count]) => {
        const placarItem = document.createElement('div');
        placarItem.className = 'placar-item';
        placarItem.innerHTML = `O ${target} j√° tomou <span class="count">${count}</span> boladas!`;
        boladasPlacar.appendChild(placarItem);
    });
  }

  async function loadHitsData() {
    const docRef = db.collection('placares').doc('hits');
    try {
      const doc = await docRef.get();
      if (doc.exists) {
        hitsData = doc.data();
      } else {
        hitsData = {};
        charactersList.forEach(hitter => {
          hitsData[hitter] = {};
        });
      }
      updatePlacar();
    } catch (e) {
      console.error("Erro ao carregar dados:", e);
    }
  }

  async function saveHitsData() {
    const docRef = db.collection('placares').doc('hits');
    try {
      await docRef.set(hitsData);
    } catch (e) {
      console.error("Erro ao salvar dados:", e);
    }
  }
  
  const beachBall = document.getElementById('beachBall');
  scene.addEventListener('click', (e) => {
    if (e.target.closest('.mural-container') || beachBall.classList.contains('thrown') || !selectedPlayer) {
      return;
    }

    const ballRect = beachBall.getBoundingClientRect();
    const sceneRect = scene.getBoundingClientRect();
    const targetX = e.clientX - sceneRect.left;
    const targetY = e.clientY - sceneRect.top;

    beachBall.style.setProperty('--target-x', `${targetX - ballRect.left - (ballRect.width / 2)}px`);
    beachBall.style.setProperty('--target-y', `${targetY - ballRect.top - (ballRect.height / 2)}px`);
    beachBall.classList.add('thrown');

    setTimeout(() => {
      const thrownBallRect = beachBall.getBoundingClientRect();
      characters.forEach(char => {
        const charRect = char.getBoundingClientRect();
        if (
          thrownBallRect.left < charRect.right && thrownBallRect.right > charRect.left &&
          thrownBallRect.top < charRect.bottom && thrownBallRect.bottom > charRect.top
        ) {
          const target = char.getAttribute('data-personagem');
          if (target !== selectedPlayer) {
            hitsData[selectedPlayer][target] = (hitsData[selectedPlayer][target] || 0) + 1;
            char.classList.add('hit');
            updatePlacar();
            setTimeout(() => char.classList.remove('hit'), 400);
            saveHitsData(); 
          }
        }
      });
    }, 250);

    setTimeout(() => {
      beachBall.classList.remove('thrown');
    }, 500);
  });

  const muralMessages = document.getElementById('muralMessages');
  const muralInput = document.getElementById('muralInput');
  const muralButton = document.getElementById('muralButton');

  muralButton.addEventListener('click', async () => {
    const message = muralInput.value.trim();
    if (message) {
      muralInput.value = '';
      try {
        await db.collection('messages').add({
          text: message,
          createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });
      } catch (e) {
        console.error("Erro ao enviar mensagem:", e);
      }
    }
  });

  db.collection('messages').orderBy('createdAt', 'desc').limit(10)
    .onSnapshot(snapshot => {
      muralMessages.innerHTML = '';  
      snapshot.forEach(doc => {
        const msg = document.createElement('div');
        msg.textContent = doc.data().text;
        muralMessages.appendChild(msg);
      });
    }, err => {
      console.error("Erro ao ouvir mensagens:", err);
    });

  document.getElementById('charSelection').addEventListener('click', (e) => {
    const clickedCard = e.target.closest('.char-card');
    if (clickedCard) {
      selectedPlayer = clickedCard.textContent.trim();
      playerSelectContainer.style.display = 'none';
      if (!hitsData[selectedPlayer]) {
          hitsData[selectedPlayer] = {};
          saveHitsData();
      }
    }
  });

  loadHitsData();
</script>
</body>
</html>
